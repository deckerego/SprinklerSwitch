<VirtualHost *:80>
        WSGIDaemonProcess sprinkler user=www-data group=www-data processes=1 threads=4
        WSGIScriptAlias /sprinkler /srv/sprinkler/routes.py

        ServerAdmin webmaster@localhost

        AddExternalAuth pwauth /usr/sbin/pwauth
        SetExternalAuthMethod pwauth pipe

        <Directory /srv/sprinkler/>
                AuthType Basic
                AuthName "Sprinkler Switch"
                AuthBasicProvider external
                AuthExternal pwauth
                Require valid-user

                WSGIProcessGroup sprinkler
                WSGIApplicationGroup %{RESOURCE}
        </Directory>

        ProxyPass /monit http://localhost:2812

        <Location /monit>
                AuthType Basic
                AuthName "Service Uptime"
                AuthBasicProvider external
                AuthExternal pwauth
                Require valid-user
        </Location>

        ErrorLog ${APACHE_LOG_DIR}/error.log

        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
